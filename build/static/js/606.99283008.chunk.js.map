{"version":3,"file":"static/js/606.99283008.chunk.js","mappings":"iOAKMA,EAAQ,IAwEd,MAjEA,aCZe,SAAmCC,GAChD,GAAW,MAAPA,EAAa,MAAM,IAAIC,UAAU,+BACvC,CDUwC,IACtC,MAA8BC,EAAAA,UAAe,GAA7C,eAAOC,EAAP,KAAgBC,EAAhB,KACA,EAA0BF,EAAAA,UAAe,GAAzC,eAAOG,EAAP,KAAcC,EAAd,KACA,EAAwBJ,EAAAA,SAAe,GAAvC,eAAOK,EAAP,KAAaC,EAAb,KACA,EAA4BN,EAAAA,SAAyB,IAArD,eAAOO,EAAP,KAAeC,EAAf,KACA,EAA0BR,EAAAA,UAAe,GAAzC,eAAOS,EAAP,KAAcC,EAAd,KALqC,SAYtBC,EAZsB,gFAYrC,qGAA0BC,EAA1B,EAA0BA,MAAOC,EAAjC,EAAiCA,OAC/BT,GAAS,GACTF,GAAW,GAFb,kBAIyBY,EAAAA,EAAAA,UAAc,CAACF,MAAAA,EAAOC,OAAAA,IAJ/C,QAIUN,EAJV,QAKcQ,OAASlB,GAAOa,GAAS,GACnCF,GAAU,SAAAQ,GAAG,OAAIA,EAAIC,OAAOV,EAAf,IACbD,GAAQ,SAAAD,GAAI,OAAIA,EAAO,CAAX,IAPhB,kDASID,GAAS,GATb,yBAWIF,GAAW,GAXf,6EAZqC,wBA2BrC,OApBAF,EAAAA,WAAgB,WACdkB,QAAQC,IAAI,SAAUZ,EAAQF,EAAMJ,GACpCU,EAAU,CAAEC,MAAOf,EAAOgB,OAAQ,GACnC,GAAE,KAkBD,iBAAKO,GAAG,aAAR,UACGnB,GAAoB,IAATI,IAAc,gFACP,IAAlBE,EAAOQ,QAAiBd,GAAYE,GAGjC,gBAAKkB,UAAU,cAAf,SACKd,EAAOe,KAAI,SAAAC,GACV,IAAIC,EAMJ,OALsBA,EAAH,KAAfD,EAAEE,SAAiC,eACf,KAAfF,EAAEE,SAAiC,eACpB,KAAfF,EAAEE,SAAiC,eACzB,WAAOF,EAAEE,SAAT,MAEZ,iBAAsBJ,UAAU,mBAAhC,WACL,gBAAKA,UAAU,2BAAf,SAA2CG,KAC3C,iBAAKH,UAAU,6BAAf,cAA8CE,EAAEG,aAChD,iBAAKL,UAAU,2BAAf,UAA2CE,EAAEI,OAA7C,qBAHeJ,EAAEG,SAKpB,OAfL,yLAmBJ,iBAAKL,UAAU,gBAAf,UACGlB,IAAS,gBAAKkB,UAAU,gBAAf,+MACG,IAAThB,GAAcF,GAAmB,IAATE,KAAgBI,IAC1C,gBACEY,UAAS,kBAAapB,EAAU,YAAc,IAC9C2B,QAAS,kBAAO3B,GAAWU,EAAU,CAAEC,MAAOf,EAAOgB,OAAQR,EAAOR,GAA3D,EAFX,SAIGI,EAAU,sDAAgB,yFAMtC,C","sources":["apps/rating/index.tsx","../node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js"],"sourcesContent":["import React from \"react\";\nimport api from \"../../api\";\nimport { Rating, TgUser } from \"../../types\";\nimport './styles.sass';\n\nconst LIMIT = 100;\n\ntype RatingAppProps = {\n  tg: any;\n  user: TgUser;\n};\n\nfunction RatingApp({}: RatingAppProps) {\n  const [loading, setLoading] = React.useState(true);\n  const [error, setError] = React.useState(false);\n  const [page, setPage] = React.useState(0);\n  const [rating, setRating] = React.useState<Rating[]>([]);\n  const [ended, setEnded] = React.useState(false);\n\n  React.useEffect(() => {\n    console.log('render', rating, page, loading);\n    getRating({ limit: LIMIT, offset: 0 });\n  }, []);\n\n  async function getRating({limit, offset}: { limit: number, offset: number }) {\n    setError(false);\n    setLoading(true);\n    try {\n      const rating = await api.getRating({limit, offset});\n      if(rating.length < LIMIT) setEnded(true);\n      setRating(old => old.concat(rating));\n      setPage(page => page + 1);\n    } catch(err) {\n      setError(true);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div id=\"rating-app\">\n      {loading && page === 0 && <h2>–ó–∞–≥—Ä—É–∑–∫–∞...</h2>}\n      {rating.length === 0 && !loading && !error\n        ? <h3>–†–µ–π—Ç–∏–Ω–≥ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø—É—Å—Ç.</h3>\n        : (\n          <div className=\"rating-list\">\n              {rating.map(u => {\n                let positionPrefix;\n                if(+u.position === 1) positionPrefix = 'ü•á';\n                else if(+u.position === 2) positionPrefix = 'ü•à';\n                else if(+u.position === 3) positionPrefix = 'ü•â';\n                else positionPrefix = `#${u.position} `;\n\n                return <div key={u.username} className=\"rating-list-item\">\n                  <div className=\"rating-list-item__prefix\">{positionPrefix}</div>\n                  <div className=\"rating-list-item__username\">@{u.username}</div>\n                  <div className=\"rating-list-item__points\">{u.points}–æ—á.</div>\n                </div>\n              })}\n          </div>\n        )\n      }\n      <div className=\"rating-footer\">\n        {error && <div className=\"loading-error\">–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.</div>}\n        {(((page === 0 && error) || page !== 0) && !ended) &&\n          <div\n            className={`more-btn${loading ? ' disabled' : ''}`}\n            onClick={() => !loading && getRating({ limit: LIMIT, offset: page * LIMIT })}\n          >\n            {loading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–ó–∞—É–≥—Ä—É–∑–∏—Ç—å –µ—â–µ'}\n          </div>\n        }\n      </div>\n    </div>\n  );\n}\n\nexport default RatingApp;\n","export default function _objectDestructuringEmpty(obj) {\n  if (obj == null) throw new TypeError(\"Cannot destructure undefined\");\n}"],"names":["LIMIT","obj","TypeError","React","loading","setLoading","error","setError","page","setPage","rating","setRating","ended","setEnded","getRating","limit","offset","api","length","old","concat","console","log","id","className","map","u","positionPrefix","position","username","points","onClick"],"sourceRoot":""}